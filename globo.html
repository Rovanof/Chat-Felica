<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç SISTEMA SOLAR 3D 2026 - VISTA CASA 1:1</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.min.js"></script>
    <!-- Leaflet para mapa de calles -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Three.js para mapas 3D -->
    <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a2a, #000033);
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            height: 100vh;
        }
        
        .container {
            display: flex;
            height: 100vh;
        }
        
        /* Panel de control mejorado */
        .control-panel {
            width: 420px;
            background: rgba(10, 15, 40, 0.98);
            padding: 25px;
            border-right: 3px solid #00ff88;
            display: flex;
            flex-direction: column;
            box-shadow: 8px 0 25px rgba(0, 255, 136, 0.3);
            z-index: 10;
            overflow-y: auto;
            backdrop-filter: blur(10px);
        }
        
        .logo {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(0, 255, 136, 0.4);
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.1), transparent);
        }
        
        .logo h1 {
            font-size: 2rem;
            color: #00ff88;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 8px;
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.7);
            font-weight: 800;
        }
        
        .logo p {
            color: #88ffcc;
            font-size: 0.9rem;
            letter-spacing: 1.5px;
        }
        
        .author {
            color: #ffaa00;
            font-weight: bold;
            font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(255, 170, 0, 0.5);
        }
        
        .version {
            color: #00aaff;
            font-size: 0.8rem;
            margin-top: 5px;
        }
        
        /* Bot√≥n de donar */
        .donate-button {
            background: linear-gradient(135deg, #ff3366, #ff0066);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(255, 51, 102, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 5px 20px rgba(255, 51, 102, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 8px 25px rgba(255, 51, 102, 0.6); }
            100% { transform: scale(1); box-shadow: 0 5px 20px rgba(255, 51, 102, 0.4); }
        }
        
        .donate-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 51, 102, 0.6);
            background: linear-gradient(135deg, #ff5588, #ff2288);
        }
        
        /* Controles */
        .controls {
            flex: 1;
        }
        
        .control-group {
            margin-bottom: 25px;
            background: rgba(20, 30, 60, 0.7);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(0, 255, 136, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .control-group h3 {
            color: #00ff88;
            margin-bottom: 18px;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid rgba(0, 255, 136, 0.2);
            padding-bottom: 10px;
        }
        
        .control-group h3 i {
            color: #ffaa00;
            font-size: 1.2rem;
        }
        
        .control-item {
            margin-bottom: 18px;
        }
        
        .control-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #aaffdd;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .slider {
            width: 100%;
            height: 8px;
            background: rgba(0, 100, 80, 0.3);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            background: #00ff88;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.8);
            border: 2px solid white;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 14px;
            cursor: pointer;
            padding: 5px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        
        .checkbox-group:hover {
            background: rgba(0, 255, 136, 0.1);
        }
        
        .checkbox-label {
            color: #aaffdd;
            font-size: 0.9rem;
            user-select: none;
            flex: 1;
            font-weight: 500;
        }
        
        .checkbox {
            width: 18px;
            height: 18px;
            background: rgba(0, 100, 80, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }
        
        .checkbox.checked {
            background: #00ff88;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.7);
        }
        
        .checkbox.checked:after {
            content: "‚úì";
            color: #003322;
            font-size: 12px;
            font-weight: bold;
        }
        
        .button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #0066cc, #00aaff);
            border: none;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
            margin-top: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(0, 102, 204, 0.3);
        }
        
        .button:hover {
            background: linear-gradient(135deg, #0088ff, #33ccff);
            box-shadow: 0 6px 20px rgba(0, 136, 255, 0.5);
            transform: translateY(-2px);
        }
        
        .button:active {
            transform: translateY(0);
        }
        
        .preset-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .preset-btn {
            padding: 10px 8px;
            background: rgba(0, 50, 100, 0.4);
            border: 1px solid #00aaff;
            color: #88ddff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s;
            text-align: center;
        }
        
        .preset-btn:hover {
            background: rgba(0, 100, 200, 0.5);
            transform: translateY(-2px);
        }
        
        .preset-btn.active {
            background: #00aaff;
            color: #001133;
            font-weight: bold;
            box-shadow: 0 0 15px rgba(0, 170, 255, 0.7);
        }
        
        /* Calendario 2026 */
        .calendar-section {
            background: rgba(10, 20, 40, 0.8);
            border-radius: 10px;
            padding: 18px;
            margin-top: 12px;
            border: 1px solid rgba(0, 170, 255, 0.3);
        }
        
        .year-display {
            text-align: center;
            font-size: 1.5rem;
            color: #ffaa00;
            margin-bottom: 15px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 170, 0, 0.5);
        }
        
        .date-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 18px;
            align-items: center;
        }
        
        .date-input {
            flex: 1;
            padding: 10px;
            background: rgba(0, 30, 60, 0.8);
            border: 1px solid #00aaff;
            border-radius: 6px;
            color: #88ddff;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .date-input:focus {
            outline: none;
            border-color: #00ff88;
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }
        
        .moon-phase-display {
            display: flex;
            align-items: center;
            gap: 18px;
            margin-top: 18px;
            padding: 15px;
            background: rgba(0, 30, 50, 0.6);
            border-radius: 10px;
            border: 1px solid rgba(0, 170, 255, 0.3);
        }
        
        .moon-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, #333, #666);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
        }
        
        .moon-phase-fill {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #eeeeee;
            clip-path: var(--moon-phase);
        }
        
        .moon-info {
            flex: 1;
        }
        
        .moon-info h4 {
            color: #ffaa00;
            margin-bottom: 8px;
            font-size: 1rem;
        }
        
        .moon-info p {
            color: #aaddff;
            font-size: 0.85rem;
            margin-bottom: 5px;
        }
        
        /* Vista Casa 1:1 */
        .house-view-section {
            background: rgba(40, 20, 10, 0.8);
            border: 2px solid #ff6600;
            border-radius: 10px;
            padding: 18px;
            margin-top: 18px;
        }
        
        .house-view-section h3 {
            color: #ff6600;
            border-bottom: 1px solid rgba(255, 102, 0, 0.3);
        }
        
        .house-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .address-input {
            flex: 1;
            padding: 10px;
            background: rgba(30, 15, 5, 0.8);
            border: 1px solid #ff6600;
            border-radius: 6px;
            color: #ffcc99;
            font-size: 0.9rem;
        }
        
        /* Mapa de calles */
        .street-map-container {
            height: 200px;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
            margin-top: 15px;
            border: 2px solid #00aaff;
            display: none;
        }
        
        #streetMap {
            width: 100%;
            height: 100%;
        }
        
        /* √Årea del sistema solar */
        .solar-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }
        
        #solarCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        /* HUD */
        .hud {
            position: absolute;
            top: 25px;
            right: 25px;
            background: rgba(10, 20, 40, 0.92);
            border: 2px solid #00ff88;
            border-radius: 12px;
            padding: 18px;
            width: 300px;
            backdrop-filter: blur(15px);
            z-index: 5;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
        }
        
        .hud h3 {
            color: #00ff88;
            margin-bottom: 12px;
            font-size: 1rem;
            text-align: center;
            border-bottom: 1px solid rgba(0, 255, 136, 0.3);
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .hud-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: #aaffdd;
            font-size: 0.85rem;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .hud-value {
            color: #00ff88;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        /* Informaci√≥n del cuerpo celeste */
        .celestial-info {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: rgba(10, 20, 40, 0.92);
            border: 2px solid #00aaff;
            border-radius: 12px;
            padding: 18px;
            width: 320px;
            backdrop-filter: blur(15px);
            z-index: 5;
            box-shadow: 0 0 30px rgba(0, 170, 255, 0.3);
        }
        
        .celestial-info h3 {
            color: #00aaff;
            margin-bottom: 12px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .celestial-details {
            color: #aaddff;
            font-size: 0.85rem;
            line-height: 1.5;
        }
        
        .celestial-details p {
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        /* Mapa 3D de calles */
        #streetView3D {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            z-index: 20;
        }
        
        .street-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00ff88;
            z-index: 21;
            display: none;
        }
        
        /* Loading screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0a0a2a, #000033);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 6px solid rgba(0, 255, 136, 0.2);
            border-top: 6px solid #00ff88;
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin-bottom: 25px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }
        
        .loading-text {
            color: #00ff88;
            font-size: 1.5rem;
            letter-spacing: 3px;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 0 0 15px rgba(0, 255, 136, 0.7);
        }
        
        .loading-subtext {
            color: #aaffdd;
            font-size: 1rem;
            text-align: center;
            max-width: 500px;
        }
        
        .loading-progress {
            width: 300px;
            height: 8px;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 4px;
            margin-top: 25px;
            overflow: hidden;
            border: 1px solid rgba(0, 255, 136, 0.3);
        }
        
        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00ffcc);
            width: 0%;
            transition: width 0.5s;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.7);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .control-panel {
                width: 100%;
                height: 45vh;
                max-height: 45vh;
                border-right: none;
                border-bottom: 3px solid #00ff88;
            }
            
            .solar-container {
                height: 55vh;
            }
        }
        
        @media (max-width: 768px) {
            .control-panel {
                padding: 15px;
            }
            
            .logo h1 {
                font-size: 1.5rem;
            }
            
            .hud, .celestial-info {
                display: none;
            }
            
            .preset-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Loading screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <div class="loading-text">SISTEMA SOLAR 2026</div>
        <div class="loading-subtext">Cargando simulador astron√≥mico con vista de casa 1:1...</div>
        <div class="loading-progress">
            <div class="loading-bar" id="loadingBar"></div>
        </div>
        <div class="loading-subtext" style="margin-top: 20px; font-size: 0.9rem; color: #ffaa00;">
            Desarrollado por <span class="author">Pierre Chenaut</span> | ¬© 2026
        </div>
    </div>
    
    <!-- Vista 3D de calles -->
    <div id="streetView3D"></div>
    <div class="street-controls" id="streetControls">
        <button class="button" id="backToSolarBtn" style="width: 200px;">
            <i class="fas fa-arrow-left"></i> Volver al Sistema Solar
        </button>
    </div>
    
    <div class="container">
        <!-- Panel de control -->
        <div class="control-panel">
            <div class="logo">
                <h1><i class="fas fa-globe-americas"></i> SISTEMA SOLAR 2026</h1>
                <p>SIMULACI√ìN ASTRON√ìMICA CON VISTA DE CASA 1:1</p>
                <p style="margin-top: 10px;">Desarrollado por <span class="author">Pierre Chenaut</span></p>
                <p class="version">Versi√≥n 2026.1 | Calendario actualizado a 2026</p>
                
                <!-- Bot√≥n de donar -->
                <button class="donate-button" id="donateButton">
                    <i class="fas fa-heart"></i> APOYAR A PIERRE CHENAUT
                </button>
            </div>
            
            <div class="controls">
                <!-- Calendario 2026 -->
                <div class="control-group">
                    <h3><i class="fas fa-calendar-alt"></i> CALENDARIO 2026</h3>
                    <div class="year-display">A√ëO 2026</div>
                    
                    <div class="date-controls">
                        <input type="date" class="date-input" id="datePicker" min="2026-01-01" max="2026-12-31" value="2026-01-01">
                        <button class="button" id="today2026Btn" style="width: auto; padding: 10px 20px;">
                            <i class="fas fa-sync-alt"></i> Hoy 2026
                        </button>
                    </div>
                    
                    <div class="control-item">
                        <div class="control-label">
                            <span>D√≠a del a√±o 2026</span>
                            <span id="currentDate">01/01/2026</span>
                        </div>
                        <input type="range" min="1" max="365" step="1" value="1" class="slider" id="dateSlider">
                    </div>
                    
                    <!-- Fase lunar 2026 -->
                    <div class="moon-phase-display">
                        <div class="moon-icon" id="moonIcon">
                            <div class="moon-phase-fill"></div>
                        </div>
                        <div class="moon-info">
                            <h4 id="moonPhaseName">Luna Nueva 2026</h4>
                            <p id="moonPhaseDetails">Iluminaci√≥n: 0%</p>
                            <p id="moonDistance">Distancia: 384,400 km</p>
                            <p id="nextFullMoon">Pr√≥xima Luna Llena: 15/01/2026</p>
                        </div>
                    </div>
                </div>
                
                <!-- Vista Casa 1:1 -->
                <div class="control-group house-view-section">
                    <h3><i class="fas fa-home"></i> VISTA CASA 1:1</h3>
                    <div class="control-label">
                        <span>Ver mi casa a escala real</span>
                        <span id="houseStatus">Desactivado</span>
                    </div>
                    
                    <div class="house-controls">
                        <input type="text" class="address-input" id="addressInput" placeholder="Ingresa tu direcci√≥n o usa GPS">
                        <button class="button" id="findHouseBtn" style="width: auto; padding: 10px 15px;">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    
                    <button class="button" id="viewHouse3DBtn">
                        <i class="fas fa-cube"></i> Activar Vista Casa 3D 1:1
                    </button>
                    
                    <!-- Mapa de calles -->
                    <div class="street-map-container" id="streetMapContainer">
                        <div id="streetMap"></div>
                    </div>
                </div>
                
                <!-- Controles del sistema -->
                <div class="control-group">
                    <h3><i class="fas fa-cogs"></i> CONTROLES DEL SISTEMA</h3>
                    <div class="control-item">
                        <div class="control-label">
                            <span>Velocidad temporal</span>
                            <span id="timeSpeedValue">1.0x</span>
                        </div>
                        <input type="range" min="0" max="200" step="1" value="10" class="slider" id="timeSpeed">
                    </div>
                    <div class="checkbox-group">
                        <div class="checkbox checked" id="autoRotationCheckbox"></div>
                        <div class="checkbox-label">Rotaci√≥n autom√°tica planetas</div>
                    </div>
                    <div class="checkbox-group">
                        <div class="checkbox checked" id="showOrbitsCheckbox"></div>
                        <div class="checkbox-label">Mostrar √≥rbitas planetarias</div>
                    </div>
                    <div class="checkbox-group">
                        <div class="checkbox checked" id="showLabelsCheckbox"></div>
                        <div class="checkbox-label">Etiquetas de planetas</div>
                    </div>
                </div>
                
                <!-- Vistas del sistema -->
                <div class="control-group">
                    <h3><i class="fas fa-eye"></i> VISTAS ESPACIALES</h3>
                    <div class="preset-buttons">
                        <button class="preset-btn active" data-preset="solar">Sistema Solar</button>
                        <button class="preset-btn" data-preset="earth">Tierra 2026</button>
                        <button class="preset-btn" data-preset="moon">Luna</button>
                        <button class="preset-btn" data-preset="mars">Marte 2026</button>
                        <button class="preset-btn" data-preset="iss">Estaci√≥n ISS</button>
                        <button class="preset-btn" data-preset="eclipse">Eclipses 2026</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- √Årea del sistema solar -->
        <div class="solar-container">
            <!-- Canvas para Three.js -->
            <canvas id="solarCanvas"></canvas>
            
            <!-- HUD -->
            <div class="hud">
                <h3><i class="fas fa-satellite"></i> ESTADO DEL SISTEMA 2026</h3>
                <div class="hud-item">
                    <span>Fecha Tierra:</span>
                    <span class="hud-value" id="earthDate">01/01/2026</span>
                </div>
                <div class="hud-item">
                    <span>D√≠a del a√±o:</span>
                    <span class="hud-value" id="dayOfYear">1/365</span>
                </div>
                <div class="hud-item">
                    <span>Velocidad temporal:</span>
                    <span class="hud-value" id="timeSpeedDisplay">1.0x</span>
                </div>
                <div class="hud-item">
                    <span>FPS:</span>
                    <span class="hud-value" id="fpsCounter">60</span>
                </div>
                <div class="hud-item">
                    <span>Modo actual:</span>
                    <span class="hud-value" id="currentMode">Sistema Solar</span>
                </div>
                <div class="hud-item">
                    <span>Desarrollador:</span>
                    <span class="hud-value" style="color: #ffaa00;">Pierre Chenaut</span>
                </div>
            </div>
            
            <!-- Informaci√≥n del cuerpo celeste -->
            <div class="celestial-info">
                <h3><i class="fas fa-globe-americas"></i> TIERRA 2026</h3>
                <div class="celestial-details">
                    <p><strong>Fecha actual:</strong> 1 de Enero 2026</p>
                    <p><strong>Poblaci√≥n estimada:</strong> 8.1 mil millones</p>
                    <p><strong>Temperatura global:</strong> +1.3¬∞C vs 1900</p>
                    <p><strong>Nivel del mar:</strong> +12 cm vs 1900</p>
                    <p><strong>Eventos 2026:</strong> Misi√≥n Artemis III a Luna</p>
                    <p><strong>Pr√≥ximo eclipse:</strong> Solar Total - 12 Ago 2026</p>
                    <p><strong>Desarrollador:</strong> Pierre Chenaut</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de donaci√≥n -->
    <div id="donationModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: linear-gradient(135deg, #1a1a3a, #0a0a2a); padding: 40px; border-radius: 20px; border: 3px solid #ff3366; max-width: 500px; text-align: center;">
            <h2 style="color: #ff3366; margin-bottom: 20px;"><i class="fas fa-heart"></i> ¬°Gracias por tu apoyo!</h2>
            <p style="color: #aaddff; margin-bottom: 25px; line-height: 1.6;">
                Este proyecto fue desarrollado con pasi√≥n por <strong style="color: #ffaa00;">Pierre Chenaut</strong>.
                Tu donaci√≥n ayuda a mantener y mejorar este simulador astron√≥mico.
            </p>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px;">
                <button class="donation-option" data-amount="5" style="padding: 15px; background: rgba(0,255,136,0.1); border: 2px solid #00ff88; color: #00ff88; border-radius: 10px; cursor: pointer;">
                    <div style="font-size: 1.5rem; font-weight: bold;">$5</div>
                    <div style="font-size: 0.8rem;">Caf√©</div>
                </button>
                <button class="donation-option" data-amount="10" style="padding: 15px; background: rgba(0,170,255,0.1); border: 2px solid #00aaff; color: #00aaff; border-radius: 10px; cursor: pointer;">
                    <div style="font-size: 1.5rem; font-weight: bold;">$10</div>
                    <div style="font-size: 0.8rem;">Colaborador</div>
                </button>
                <button class="donation-option" data-amount="25" style="padding: 15px; background: rgba(255,170,0,0.1); border: 2px solid #ffaa00; color: #ffaa00; border-radius: 10px; cursor: pointer;">
                    <div style="font-size: 1.5rem; font-weight: bold;">$25</div>
                    <div style="font-size: 0.8rem;">Soporte</div>
                </button>
                <button class="donation-option" data-amount="50" style="padding: 15px; background: rgba(255,51,102,0.1); border: 2px solid #ff3366; color: #ff3366; border-radius: 10px; cursor: pointer;">
                    <div style="font-size: 1.5rem; font-weight: bold;">$50</div>
                    <div style="font-size: 0.8rem;">Patrocinador</div>
                </button>
            </div>
            <input type="number" id="customAmount" placeholder="Otra cantidad $" style="width: 100%; padding: 15px; background: rgba(255,255,255,0.1); border: 2px solid #00ff88; color: white; border-radius: 10px; margin-bottom: 20px; font-size: 1.2rem; text-align: center;">
            <button id="confirmDonation" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #ff3366, #ff0066); color: white; border: none; border-radius: 10px; font-size: 1.2rem; font-weight: bold; cursor: pointer; margin-bottom: 15px;">
                <i class="fas fa-gift"></i> Donar ahora
            </button>
            <button id="closeDonationModal" style="width: 100%; padding: 10px; background: transparent; color: #aaddff; border: 1px solid #00aaff; border-radius: 10px; cursor: pointer;">
                Cancelar
            </button>
        </div>
    </div>

    <script>
        // ============================
        // CONFIGURACI√ìN 2026
        // ============================
        
        // Variables globales
        let scene, camera, renderer, controls;
        let sun, earth, moon, planets = {};
        let orbits = [], labels = [];
        let streetMap, streetViewer;
        
        // Configuraci√≥n 2026
        const CURRENT_YEAR = 2026;
        let currentDate = new Date(`${CURRENT_YEAR}-01-01`);
        let dayOfYear = 1;
        let isPaused = false;
        let currentView = 'solar';
        let timeSpeed = 1.0;
        
        // Variables de estado
        let objectsLoaded = 0;
        let totalObjects = 14;
        
        // Eclipses 2026 (datos reales aproximados)
        const eclipses2026 = [
            { date: '2026-02-17', type: 'Lunar', name: 'Eclipse Lunar Penumbral' },
            { date: '2026-02-28', type: 'Solar', name: 'Eclipse Solar Anular' },
            { date: '2026-08-02', type: 'Solar', name: 'Eclipse Solar Anular' },
            { date: '2026-08-12', type: 'Solar', name: 'Eclipse Solar Total' },
            { date: '2026-08-28', type: 'Lunar', name: 'Eclipse Lunar Parcial' }
        ];
        
        // ============================
        // INICIALIZACI√ìN
        // ============================
        
        async function initSystem() {
            updateLoadingProgress(10);
            
            // Inicializar Three.js
            initThreeJS();
            
            updateLoadingProgress(40);
            
            // Configurar controles UI
            setupUIControls();
            
            updateLoadingProgress(60);
            
            // Inicializar mapa de calles
            initStreetMap();
            
            updateLoadingProgress(80);
            
            // Configurar eventos
            setupEventListeners();
            
            updateLoadingProgress(100);
            
            // Ocultar pantalla de carga
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
                animate();
                showNotification(`Sistema Solar ${CURRENT_YEAR} cargado - Por Pierre Chenaut`);
            }, 800);
        }
        
        function initThreeJS() {
            // 1. Escena
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000010);
            
            // 2. C√°mara
            const canvas = document.getElementById('solarCanvas');
            camera = new THREE.PerspectiveCamera(75, canvas.clientWidth / canvas.clientHeight, 0.1, 10000);
            camera.position.set(0, 50, 150);
            
            // 3. Renderizador
            renderer = new THREE.WebGLRenderer({ 
                canvas: canvas,
                antialias: true,
                alpha: true
            });
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            
            // 4. Controles
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 10;
            controls.maxDistance = 5000;
            
            // 5. Crear sistema solar b√°sico
            createSolarSystem();
            
            // 6. Crear campo de estrellas
            createStarfield();
        }
        
        function createSolarSystem() {
            // Sol
            const sunGeometry = new THREE.SphereGeometry(15, 32, 32);
            const sunMaterial = new THREE.MeshBasicMaterial({
                color: 0xFFD700,
                emissive: 0xFF4500,
                emissiveIntensity: 0.8
            });
            sun = new THREE.Mesh(sunGeometry, sunMaterial);
            scene.add(sun);
            objectsLoaded++;
            
            // Luz solar
            const sunLight = new THREE.PointLight(0xFFFFFF, 2, 1000);
            sun.add(sunLight);
            
            // Tierra 2026
            const earthGeometry = new THREE.SphereGeometry(5, 32, 32);
            const earthMaterial = new THREE.MeshPhongMaterial({
                color: 0x2233FF,
                specular: 0x222222,
                shininess: 10
            });
            earth = new THREE.Mesh(earthGeometry, earthMaterial);
            earth.position.x = 50;
            earth.name = "Tierra 2026";
            earth.userData.year = CURRENT_YEAR;
            scene.add(earth);
            objectsLoaded++;
            
            // Luna
            const moonGeometry = new THREE.SphereGeometry(1.5, 16, 16);
            const moonMaterial = new THREE.MeshPhongMaterial({
                color: 0x888888,
                shininess: 5
            });
            moon = new THREE.Mesh(moonGeometry, moonMaterial);
            moon.position.set(55, 0, 0);
            earth.add(moon);
            objectsLoaded++;
            
            // √ìrbitas
            createOrbits();
            
            // Otros planetas (simplificados)
            createOtherPlanets();
        }
        
        function createStarfield() {
            const starsGeometry = new THREE.BufferGeometry();
            const starsCount = 5000;
            const positions = new Float32Array(starsCount * 3);
            
            for (let i = 0; i < starsCount * 3; i += 3) {
                positions[i] = (Math.random() - 0.5) * 2000;
                positions[i + 1] = (Math.random() - 0.5) * 2000;
                positions[i + 2] = (Math.random() - 0.5) * 2000;
            }
            
            starsGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            
            const starsMaterial = new THREE.PointsMaterial({
                color: 0xFFFFFF,
                size: 1.5,
                sizeAttenuation: true
            });
            
            const stars = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(stars);
            objectsLoaded++;
        }
        
        function createOrbits() {
            const orbitMaterial = new THREE.LineBasicMaterial({ color: 0x4488FF, transparent: true, opacity: 0.3 });
            
            // √ìrbita terrestre
            const earthOrbitPoints = [];
            const segments = 64;
            for (let i = 0; i <= segments; i++) {
                const angle = (i / segments) * Math.PI * 2;
                earthOrbitPoints.push(new THREE.Vector3(
                    Math.cos(angle) * 50,
                    0,
                    Math.sin(angle) * 50
                ));
            }
            
            const earthOrbitGeometry = new THREE.BufferGeometry().setFromPoints(earthOrbitPoints);
            const earthOrbit = new THREE.Line(earthOrbitGeometry, orbitMaterial);
            scene.add(earthOrbit);
            orbits.push(earthOrbit);
            objectsLoaded++;
        }
        
        function createOtherPlanets() {
            const planetData = [
                { name: "Mercurio", size: 2, distance: 20, color: 0x8C7853 },
                { name: "Venus", size: 4, distance: 35, color: 0xFFC649 },
                { name: "Marte", size: 3, distance: 65, color: 0xFF3300 },
                { name: "J√∫piter", size: 10, distance: 100, color: 0xFFAA66 },
                { name: "Saturno", size: 8, distance: 130, color: 0xDDCC99 },
                { name: "Urano", size: 6, distance: 160, color: 0x66CCFF },
                { name: "Neptuno", size: 5.8, distance: 190, color: 0x3366FF }
            ];
            
            planetData.forEach((planet, index) => {
                const geometry = new THREE.SphereGeometry(planet.size, 16, 16);
                const material = new THREE.MeshPhongMaterial({ color: planet.color });
                const mesh = new THREE.Mesh(geometry, material);
                
                const angle = (index / planetData.length) * Math.PI * 2;
                mesh.position.x = Math.cos(angle) * planet.distance;
                mesh.position.z = Math.sin(angle) * planet.distance;
                mesh.name = planet.name;
                
                scene.add(mesh);
                planets[planet.name] = mesh;
                objectsLoaded++;
            });
        }
        
        function initStreetMap() {
            // Inicializar Leaflet para mapa de calles
            streetMap = L.map('streetMap').setView([40.7128, -74.0060], 15);
            
            // Capa de calles de OpenStreetMap
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(streetMap);
            
            // A√±adir marcador por defecto (NYC)
            const marker = L.marker([40.7128, -74.0060]).addTo(streetMap)
                .bindPopup('Ubicaci√≥n por defecto<br>Usa la b√∫squeda para encontrar tu casa')
                .openPopup();
        }
        
        // ============================
        // CONTROLES UI
        // ============================
        
        function setupUIControls() {
            // Bot√≥n de donar
            document.getElementById('donateButton').addEventListener('click', showDonationModal);
            
            // Cerrar modal de donaci√≥n
            document.getElementById('closeDonationModal').addEventListener('click', () => {
                document.getElementById('donationModal').style.display = 'none';
            });
            
            // Confirmar donaci√≥n
            document.getElementById('confirmDonation').addEventListener('click', () => {
                const amount = document.getElementById('customAmount').value || 10;
                showNotification(`¬°Gracias por tu donaci√≥n de $${amount}! Pierre Chenaut lo aprecia.`);
                document.getElementById('donationModal').style.display = 'none';
            });
            
            // Opciones de donaci√≥n
            document.querySelectorAll('.donation-option').forEach(option => {
                option.addEventListener('click', () => {
                    const amount = option.dataset.amount;
                    document.getElementById('customAmount').value = amount;
                });
            });
            
            // Fecha 2026
            const datePicker = document.getElementById('datePicker');
            datePicker.min = `${CURRENT_YEAR}-01-01`;
            datePicker.max = `${CURRENT_YEAR}-12-31`;
            datePicker.value = `${CURRENT_YEAR}-01-01`;
            
            datePicker.addEventListener('change', function() {
                currentDate = new Date(this.value);
                updateDateDisplay();
                checkEclipses2026();
            });
            
            // Deslizador de fecha
            const dateSlider = document.getElementById('dateSlider');
            dateSlider.addEventListener('input', function() {
                dayOfYear = parseInt(this.value);
                updateDateFromDay();
            });
            
            // Bot√≥n hoy 2026
            document.getElementById('today2026Btn').addEventListener('click', function() {
                // Simular fecha de hoy en 2026 (usamos una fecha espec√≠fica)
                currentDate = new Date(`${CURRENT_YEAR}-06-15`);
                updateDateDisplay();
                checkEclipses2026();
                showNotification(`Fecha actualizada a 15 de Junio ${CURRENT_YEAR}`);
            });
            
            // Velocidad temporal
            const timeSpeedSlider = document.getElementById('timeSpeed');
            timeSpeedSlider.addEventListener('input', function() {
                timeSpeed = this.value / 10;
                document.getElementById('timeSpeedValue').textContent = `${timeSpeed.toFixed(1)}x`;
                document.getElementById('timeSpeedDisplay').textContent = `${timeSpeed.toFixed(1)}x`;
            });
            
            // Vista Casa 3D
            document.getElementById('viewHouse3DBtn').addEventListener('click', function() {
                showHouse3DView();
            });
            
            // Buscar casa
            document.getElementById('findHouseBtn').addEventListener('click', function() {
                searchAddress();
            });
            
            // Volver al sistema solar desde vista casa
            document.getElementById('backToSolarBtn').addEventListener('click', function() {
                document.getElementById('streetView3D').style.display = 'none';
                document.getElementById('streetControls').style.display = 'none';
                document.getElementById('solarCanvas').style.display = 'block';
                currentView = 'solar';
                document.getElementById('currentMode').textContent = 'Sistema Solar';
                showNotification('Volviendo al Sistema Solar 2026');
            });
            
            // Vistas predefinidas
            document.querySelectorAll('.preset-btn').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.preset-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    currentView = this.dataset.preset;
                    document.getElementById('currentMode').textContent = this.textContent;
                    switchView(currentView);
                });
            });
            
            // Inicializar display de fecha
            updateDateDisplay();
            checkEclipses2026();
        }
        
        function updateDateDisplay() {
            const day = currentDate.getDate();
            const month = currentDate.getMonth() + 1;
            const year = currentDate.getFullYear();
            
            // Calcular d√≠a del a√±o
            const start = new Date(year, 0, 0);
            const diff = currentDate - start;
            const oneDay = 1000 * 60 * 60 * 24;
            dayOfYear = Math.floor(diff / oneDay);
            
            // Actualizar UI
            document.getElementById('currentDate').textContent = 
                `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${year}`;
            document.getElementById('dateSlider').value = dayOfYear;
            document.getElementById('datePicker').value = currentDate.toISOString().split('T')[0];
            document.getElementById('dayOfYear').textContent = `${dayOfYear}/365`;
            document.getElementById('earthDate').textContent = 
                `${day.toString().padStart(2, '0')}/${month.toString().padStart(2, '0')}/${year}`;
            
            // Actualizar fase lunar
            updateMoonPhase2026();
        }
        
        function updateDateFromDay() {
            currentDate = new Date(CURRENT_YEAR, 0, dayOfYear);
            updateDateDisplay();
        }
        
        function updateMoonPhase2026() {
            // Fase lunar basada en fecha 2026
            const lunarCycle = 29.53;
            const knownNewMoon2026 = new Date('2026-01-08'); // Luna nueva conocida para 2026
            
            const diffDays = (currentDate - knownNewMoon2026) / (1000 * 60 * 60 * 24);
            const moonPhase = (diffDays % lunarCycle) / lunarCycle;
            const illumination = Math.abs(Math.sin(moonPhase * Math.PI * 2)) * 100;
            
            const phases = [
                { name: "Luna Nueva", min: 0, max: 0.03 },
                { name: "Luna Creciente", min: 0.03, max: 0.22 },
                { name: "Cuarto Creciente", min: 0.22, max: 0.28 },
                { name: "Gibosa Creciente", min: 0.28, max: 0.47 },
                { name: "Luna Llena", min: 0.47, max: 0.53 },
                { name: "Gibosa Menguante", min: 0.53, max: 0.72 },
                { name: "Cuarto Menguante", min: 0.72, max: 0.78 },
                { name: "Luna Menguante", min: 0.78, max: 0.97 },
                { name: "Luna Nueva", min: 0.97, max: 1.0 }
            ];
            
            let phaseName = "Luna Nueva";
            for (const phase of phases) {
                if (moonPhase >= phase.min && moonPhase < phase.max) {
                    phaseName = phase.name;
                    break;
                }
            }
            
            // Actualizar UI
            document.getElementById('moonPhaseName').textContent = `${phaseName} ${CURRENT_YEAR}`;
            document.getElementById('moonPhaseDetails').textContent = `Iluminaci√≥n: ${illumination.toFixed(1)}%`;
            
            // Calcular pr√≥xima luna llena
            const daysToFull = (0.5 - moonPhase) * lunarCycle;
            if (daysToFull < 0) daysToFull += lunarCycle;
            const nextFullMoon = new Date(currentDate.getTime() + daysToFull * 24 * 60 * 60 * 1000);
            const nextFullDay = nextFullMoon.getDate();
            const nextFullMonth = nextFullMoon.getMonth() + 1;
            document.getElementById('nextFullMoon').textContent = 
                `Pr√≥x. Luna Llena: ${nextFullDay.toString().padStart(2, '0')}/${nextFullMonth.toString().padStart(2, '0')}/${CURRENT_YEAR}`;
            
            // Actualizar icono
            updateMoonIcon(moonPhase, illumination);
        }
        
        function updateMoonIcon(moonPhase, illumination) {
            const moonIcon = document.getElementById('moonIcon');
            let clipPath = '';
            
            if (moonPhase < 0.25) {
                const width = (illumination / 25) * 100;
                clipPath = `inset(0 ${100 - width}% 0 0)`;
            } else if (moonPhase < 0.5) {
                const width = ((illumination - 25) / 25) * 100;
                clipPath = `inset(0 0 0 ${100 - width}%)`;
            } else if (moonPhase < 0.75) {
                const width = ((illumination - 25) / 25) * 100;
                clipPath = `inset(0 0 0 ${width}%)`;
            } else {
                const width = (illumination / 25) * 100;
                clipPath = `inset(0 ${width}% 0 0)`;
            }
            
            moonIcon.style.setProperty('--moon-phase', clipPath);
        }
        
        function checkEclipses2026() {
            const dateStr = currentDate.toISOString().split('T')[0];
            const eclipse = eclipses2026.find(e => e.date === dateStr);
            
            if (eclipse) {
                showNotification(`‚ö†Ô∏è ${eclipse.name} detectado para hoy!`, true);
            }
        }
        
        function switchView(view) {
            switch(view) {
                case 'solar':
                    camera.position.set(0, 50, 150);
                    controls.target.set(0, 0, 0);
                    break;
                case 'earth':
                    camera.position.copy(earth.position);
                    camera.position.y += 20;
                    camera.position.z += 30;
                    controls.target.copy(earth.position);
                    break;
                case 'moon':
                    const moonWorldPos = new THREE.Vector3();
                    moon.getWorldPosition(moonWorldPos);
                    camera.position.copy(moonWorldPos);
                    camera.position.y += 10;
                    camera.position.z += 15;
                    controls.target.copy(moonWorldPos);
                    break;
                case 'mars':
                    const mars = planets["Marte"];
                    if (mars) {
                        camera.position.copy(mars.position);
                        camera.position.y += 15;
                        camera.position.z += 20;
                        controls.target.copy(mars.position);
                    }
                    break;
                case 'iss':
                    // Simular posici√≥n ISS
                    camera.position.set(0, 0.5, 50.5);
                    controls.target.copy(earth.position);
                    break;
                case 'eclipse':
                    // Vista para eclipse
                    camera.position.set(0, 10, 60);
                    controls.target.copy(earth.position);
                    showNotification('Modo Eclipse activado - Buscando alineaciones...');
                    break;
            }
        }
        
        function searchAddress() {
            const address = document.getElementById('addressInput').value;
            
            if (!address) {
                // Usar geolocalizaci√≥n
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(position => {
                        const lat = position.coords.latitude;
                        const lon = position.coords.longitude;
                        streetMap.setView([lat, lon], 18);
                        
                        // A√±adir marcador
                        L.marker([lat, lon]).addTo(streetMap)
                            .bindPopup('Tu ubicaci√≥n actual<br>Pierre Chenaut te saluda!')
                            .openPopup();
                        
                        // Mostrar mapa
                        document.getElementById('streetMapContainer').style.display = 'block';
                        document.getElementById('houseStatus').textContent = 'Ubicaci√≥n encontrada';
                        document.getElementById('houseStatus').style.color = '#00ff88';
                        
                        showNotification('Ubicaci√≥n encontrada por GPS - Listo para vista 3D');
                    });
                }
            } else {
                // B√∫squeda por direcci√≥n (simulada)
                showNotification(`Buscando: ${address}... (simulaci√≥n)`);
                
                // Coordenadas simuladas para direcci√≥n
                const simulatedLat = 40.7128 + (Math.random() - 0.5) * 0.1;
                const simulatedLon = -74.0060 + (Math.random() - 0.5) * 0.1;
                
                streetMap.setView([simulatedLat, simulatedLon], 18);
                
                L.marker([simulatedLat, simulatedLon]).addTo(streetMap)
                    .bindPopup(`Direcci√≥n: ${address}<br>Vista simulada para demo`)
                    .openPopup();
                
                document.getElementById('streetMapContainer').style.display = 'block';
                document.getElementById('houseStatus').textContent = 'Direcci√≥n encontrada';
                document.getElementById('houseStatus').style.color = '#00ff88';
            }
        }
        
        function showHouse3DView() {
            // Crear escena 3D para vista de casa
            const container = document.getElementById('streetView3D');
            container.style.display = 'block';
            document.getElementById('streetControls').style.display = 'block';
            document.getElementById('solarCanvas').style.display = 'none';
            
            // Limpiar contenedor
            container.innerHTML = '';
            
            // Crear escena 3D simple para casa
            const houseScene = new THREE.Scene();
            houseScene.background = new THREE.Color(0x87CEEB);
            
            const houseCamera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
            houseCamera.position.set(10, 5, 10);
            
            const houseRenderer = new THREE.WebGLRenderer({ antialias: true });
            houseRenderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(houseRenderer.domElement);
            
            const houseControls = new THREE.OrbitControls(houseCamera, houseRenderer.domElement);
            
            // A√±adir luz
            const light = new THREE.DirectionalLight(0xffffff, 1);
            light.position.set(5, 10, 5);
            houseScene.add(light);
            houseScene.add(new THREE.AmbientLight(0x404040));
            
            // Crear modelo de casa simple
            createHouseModel(houseScene);
            
            // Crear entorno (calles, √°rboles, etc.)
            createNeighborhood(houseScene);
            
            // A√±adir texto flotante
            addFloatingText(houseScene, "CASA DE PIERRE CHENAUT", 0, 8, 0);
            addFloatingText(houseScene, "VISTA 1:1 - A√ëO 2026", 0, 7, 0);
            
            // Animaci√≥n
            function animateHouse() {
                requestAnimationFrame(animateHouse);
                houseControls.update();
                houseRenderer.render(houseScene, houseCamera);
            }
            animateHouse();
            
            currentView = 'house';
            document.getElementById('currentMode').textContent = 'Vista Casa 1:1';
            showNotification('Vista Casa 1:1 activada - Por Pierre Chenaut');
        }
        
        function createHouseModel(scene) {
            // Casa principal
            const houseGeometry = new THREE.BoxGeometry(8, 6, 8);
            const houseMaterial = new THREE.MeshPhongMaterial({ color: 0x8B4513 });
            const house = new THREE.Mesh(houseGeometry, houseMaterial);
            house.position.y = 3;
            scene.add(house);
            
            // Techo
            const roofGeometry = new THREE.ConeGeometry(6, 4, 4);
            const roofMaterial = new THREE.MeshPhongMaterial({ color: 0x8B0000 });
            const roof = new THREE.Mesh(roofGeometry, roofMaterial);
            roof.position.y = 7;
            roof.rotation.y = Math.PI / 4;
            scene.add(roof);
            
            // Puerta
            const doorGeometry = new THREE.BoxGeometry(1.5, 2.5, 0.2);
            const doorMaterial = new THREE.MeshPhongMaterial({ color: 0x654321 });
            const door = new THREE.Mesh(doorGeometry, doorMaterial);
            door.position.set(0, 1.25, 4.1);
            scene.add(door);
            
            // Ventanas
            for (let i = -1; i <= 1; i += 2) {
                for (let j = -1; j <= 1; j += 2) {
                    const windowGeometry = new THREE.BoxGeometry(1, 1, 0.1);
                    const windowMaterial = new THREE.MeshPhongMaterial({ color: 0x87CEEB, transparent: true, opacity: 0.7 });
                    const windowMesh = new THREE.Mesh(windowGeometry, windowMaterial);
                    windowMesh.position.set(i * 2, 3, j > 0 ? 4.1 : -4.1);
                    scene.add(windowMesh);
                }
            }
            
            // Suelo
            const groundGeometry = new THREE.PlaneGeometry(100, 100);
            const groundMaterial = new THREE.MeshPhongMaterial({ color: 0x228B22 });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            scene.add(ground);
            
            // Camino
            const pathGeometry = new THREE.PlaneGeometry(4, 20);
            const pathMaterial = new THREE.MeshPhongMaterial({ color: 0x808080 });
            const path = new THREE.Mesh(pathGeometry, pathMaterial);
            path.position.set(0, 0.01, -10);
            path.rotation.x = -Math.PI / 2;
            scene.add(path);
        }
        
        function createNeighborhood(scene) {
            // Crear algunas casas vecinas
            for (let i = 0; i < 5; i++) {
                const angle = (i / 5) * Math.PI * 2;
                const distance = 15 + Math.random() * 10;
                
                const houseX = Math.cos(angle) * distance;
                const houseZ = Math.sin(angle) * distance;
                
                const houseGeometry = new THREE.BoxGeometry(5, 4, 5);
                const houseMaterial = new THREE.MeshPhongMaterial({ 
                    color: Math.random() * 0xffffff 
                });
                const house = new THREE.Mesh(houseGeometry, houseMaterial);
                house.position.set(houseX, 2, houseZ);
                scene.add(house);
                
                // Techo
                const roofGeometry = new THREE.ConeGeometry(4, 3, 4);
                const roof = new THREE.Mesh(roofGeometry, houseMaterial);
                roof.position.set(houseX, 5.5, houseZ);
                roof.rotation.y = Math.PI / 4;
                scene.add(roof);
            }
            
            // √Årboles
            for (let i = 0; i < 20; i++) {
                const angle = Math.random() * Math.PI * 2;
                const distance = 20 + Math.random() * 30;
                
                const treeX = Math.cos(angle) * distance;
                const treeZ = Math.sin(angle) * distance;
                
                // Tronco
                const trunkGeometry = new THREE.CylinderGeometry(0.3, 0.4, 2);
                const trunkMaterial = new THREE.MeshPhongMaterial({ color: 0x8B4513 });
                const trunk = new THREE.Mesh(trunkGeometry, trunkMaterial);
                trunk.position.set(treeX, 1, treeZ);
                scene.add(trunk);
                
                // Copa
                const leavesGeometry = new THREE.SphereGeometry(2, 8, 8);
                const leavesMaterial = new THREE.MeshPhongMaterial({ color: 0x228B22 });
                const leaves = new THREE.Mesh(leavesGeometry, leavesMaterial);
                leaves.position.set(treeX, 3.5, treeZ);
                scene.add(leaves);
            }
            
            // Postes de luz
            for (let i = 0; i < 8; i++) {
                const angle = (i / 8) * Math.PI * 2;
                const distance = 12;
                
                const lightX = Math.cos(angle) * distance;
                const lightZ = Math.sin(angle) * distance;
                
                // Poste
                const poleGeometry = new THREE.CylinderGeometry(0.1, 0.1, 5);
                const poleMaterial = new THREE.MeshPhongMaterial({ color: 0x333333 });
                const pole = new THREE.Mesh(poleGeometry, poleMaterial);
                pole.position.set(lightX, 2.5, lightZ);
                scene.add(pole);
                
                // Luz
                const lightGeometry = new THREE.SphereGeometry(0.3);
                const lightMaterial = new THREE.MeshBasicMaterial({ color: 0xFFFF00 });
                const lightSphere = new THREE.Mesh(lightGeometry, lightMaterial);
                lightSphere.position.set(lightX, 5, lightZ);
                scene.add(lightSphere);
                
                // Luz puntual
                const pointLight = new THREE.PointLight(0xFFFF00, 1, 10);
                pointLight.position.set(lightX, 5, lightZ);
                scene.add(pointLight);
            }
        }
        
        function addFloatingText(scene, text, x, y, z) {
            // Crear texto usando geometr√≠a b√°sica (simplificado)
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 128;
            
            context.fillStyle = 'rgba(0, 0, 0, 0)';
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            context.font = 'bold 40px Arial';
            context.fillStyle = '#FFFFFF';
            context.textAlign = 'center';
            context.fillText(text, canvas.width/2, canvas.height/2);
            
            context.strokeStyle = '#00FF88';
            context.lineWidth = 4;
            context.strokeText(text, canvas.width/2, canvas.height/2);
            
            const texture = new THREE.CanvasTexture(canvas);
            const material = new THREE.SpriteMaterial({ map: texture });
            const sprite = new THREE.Sprite(material);
            sprite.position.set(x, y, z);
            sprite.scale.set(10, 2.5, 1);
            scene.add(sprite);
        }
        
        function showDonationModal() {
            document.getElementById('donationModal').style.display = 'flex';
        }
        
        // ============================
        // EVENTOS Y ANIMACI√ìN
        // ============================
        
        function setupEventListeners() {
            // Redimensionar
            window.addEventListener('resize', onWindowResize);
            
            // Teclado
            document.addEventListener('keydown', onKeyDown);
        }
        
        function onWindowResize() {
            const canvas = document.getElementById('solarCanvas');
            camera.aspect = canvas.clientWidth / canvas.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvas.clientWidth, canvas.clientHeight);
        }
        
        function onKeyDown(e) {
            switch(e.key) {
                case ' ':
                    isPaused = !isPaused;
                    showNotification(isPaused ? 'SIMULACI√ìN PAUSADA' : 'SIMULACI√ìN REANUDADA');
                    break;
                case 'd':
                case 'D':
                    showDonationModal();
                    break;
                case '1':
                    document.querySelector('[data-preset="solar"]').click();
                    break;
                case '2':
                    document.querySelector('[data-preset="earth"]').click();
                    break;
                case '3':
                    document.querySelector('[data-preset="house"]').click();
                    break;
            }
        }
        
        function updateLoadingProgress(percent) {
            document.getElementById('loadingBar').style.width = `${percent}%`;
            document.getElementById('objectsLoaded').textContent = `${objectsLoaded}/${totalObjects}`;
        }
        
        function showNotification(message, isWarning = false) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                padding: 15px 30px;
                background: ${isWarning ? 'rgba(255, 100, 0, 0.95)' : 'rgba(0, 40, 80, 0.95)'};
                color: ${isWarning ? '#FFCC00' : '#00FF88'};
                border: 2px solid ${isWarning ? '#FF6600' : '#00FF88'};
                border-radius: 12px;
                z-index: 1000;
                font-family: 'Segoe UI', sans-serif;
                font-size: 0.95rem;
                box-shadow: 0 5px 25px rgba(0, 255, 136, 0.4);
                animation: fadeInOut 3s ease-in-out;
                backdrop-filter: blur(10px);
                text-align: center;
                max-width: 80%;
                font-weight: 600;
            `;
            
            notification.innerHTML = `
                <i class="fas ${isWarning ? 'fa-exclamation-triangle' : 'fa-info-circle'}"></i>
                ${message}
                ${!isWarning ? '<br><small style="opacity:0.8;">Por Pierre Chenaut</small>' : ''}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.5s ease-in-out';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }
        
        // ============================
        // ANIMACI√ìN PRINCIPAL
        // ============================
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (!isPaused) {
                // Rotar cuerpos celestes
                sun.rotation.y += 0.002 * timeSpeed;
                earth.rotation.y += 0.01 * timeSpeed;
                moon.rotation.y += 0.005 * timeSpeed;
                
                // Orbitar planetas
                Object.values(planets).forEach(planet => {
                    planet.rotation.y += 0.005 * timeSpeed;
                });
                
                // Mover Tierra y Luna en √≥rbita
                const earthAngle = Date.now() * 0.0001 * timeSpeed;
                earth.position.x = Math.cos(earthAngle) * 50;
                earth.position.z = Math.sin(earthAngle) * 50;
                
                const moonAngle = Date.now() * 0.001 * timeSpeed;
                moon.position.x = Math.cos(moonAngle) * 8;
                moon.position.z = Math.sin(moonAngle) * 8;
                
                // Mover otros planetas
                let planetIndex = 0;
                Object.values(planets).forEach(planet => {
                    planetIndex++;
                    const planetSpeed = 0.0005 * timeSpeed / planetIndex;
                    const planetAngle = Date.now() * planetSpeed;
                    const distance = 20 + planetIndex * 15;
                    
                    planet.position.x = Math.cos(planetAngle + planetIndex) * distance;
                    planet.position.z = Math.sin(planetAngle + planetIndex) * distance;
                });
            }
            
            controls.update();
            renderer.render(scene, camera);
        }
        
        // ============================
        // INICIALIZAR SISTEMA
        // ============================
        
        window.addEventListener('load', () => {
            setTimeout(() => {
                try {
                    initSystem();
                } catch (error) {
                    console.error("Error:", error);
                    document.getElementById('loadingScreen').innerHTML = `
                        <div style="text-align: center; color: #ff3366;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 20px;"></i>
                            <h2>ERROR EN EL SISTEMA SOLAR 2026</h2>
                            <p>Contacta a Pierre Chenaut para soporte t√©cnico</p>
                            <button onclick="location.reload()" style="
                                background: linear-gradient(135deg, #ff3366, #ff0066);
                                color: white;
                                border: none;
                                padding: 15px 30px;
                                border-radius: 10px;
                                margin-top: 20px;
                                cursor: pointer;
                                font-size: 1.1rem;
                                font-weight: bold;
                            ">
                                <i class="fas fa-redo"></i> Reintentar
                            </button>
                        </div>
                    `;
                }
            }, 1500);
        });
    </script>
</body>
</html>
